<!doctype html>
<html lang="en" class="preload">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>{%
            if page and page.title
        %}{{ page.title }} - {{ config.title }}{%
            elif section and section.title
        %}{{ section.title }} - {{ config.title }}{%
            else
        %}{{ config.title }}{%
            endif
        %}</title>
        <link rel="stylesheet" href="{{ get_url(path='cat.css') }}" />
    </head>

    <body>
        <div class="container">
            <header class="card">
                <div class="header-left">
                    <a href="{{ config.base_url }}">{{ config.title }}</a>
                </div>
                <div class="header-right">
                    <nav>
                        {% for item in config.extra.menu %}<a
                            href="{{ get_url(path=item.url) }}"
                            >{{ item.name }}</a
                        >{% endfor %}
                    </nav>
                    <a id="theme-toggle" class="theme-toggle">
                        <svg
                            id="icon-sun"
                            xmlns="http://www.w3.org/2000/svg"
                            width="24"
                            height="24"
                            fill="currentColor"
                            shape-rendering="crispEdges"
                        >
                            <path
                                d="M13 0h-2v4h2V0ZM0 11v2h4v-2H0Zm24 0v2h-4v-2h4ZM13 24h-2v-4h2v4ZM8 6h8v2H8V6ZM6 8h2v8H6V8Zm2 10v-2h8v2H8Zm10-2h-2V8h2v8Zm2-14h2v2h-2V2Zm0 2v2h-2V4h2Zm2 18h-2v-2h2v2Zm-2-2h-2v-2h2v2ZM4 2H2v2h2v2h2V4H4V2ZM2 22h2v-2h2v-2H4v2H2v2Z"
                            />
                        </svg>
                        <svg
                            id="icon-moon"
                            xmlns="http://www.w3.org/2000/svg"
                            width="24"
                            height="24"
                            fill="currentColor"
                            shape-rendering="crispEdges"
                        >
                            <path
                                d="M6 2h8v2h-2v2h-2V4H6V2ZM4 6V4h2v2H4Zm0 10H2V6h2v10Zm2 2H4v-2h2v2Zm2 2H6v-2h2v2Zm10 0v2H8v-2h10Zm2-2v2h-2v-2h2Zm-2-4h2v4h2v-8h-2v2h-2v2Zm-6 0v2h6v-2h-6Zm-2-2h2v2h-2v-2Zm0 0V6H8v6h2Z"
                            />
                        </svg>
                    </a>
                </div>
            </header>
            <main>{% block content %}{% endblock %}</main>
            <footer>
                <p>
                    Â© {{ now() | date(format="%Y") }} {{ config.author }}. All rights
                    reserved.
                </p>
            </footer>
        </div>
        <script>
            const themeToggle = document.getElementById("theme-toggle");
            const sunIcon = document.getElementById("icon-sun");
            const moonIcon = document.getElementById("icon-moon");
            const html = document.documentElement;

            // Set initial theme
            const storedTheme = localStorage.getItem("theme");
            const preferredTheme = window.matchMedia(
                "(prefers-color-scheme: light)",
            ).matches
                ? "light"
                : "dark";
            const currentTheme = storedTheme || preferredTheme;
            html.setAttribute("data-theme", currentTheme);

            const [iconToShow, iconToHide] =
                currentTheme === "light"
                    ? [moonIcon, sunIcon]
                    : [sunIcon, moonIcon];
            iconToShow.style.display = "";
            iconToHide.style.display = "none";

            themeToggle.addEventListener("click", () => {
                const newTheme =
                    html.getAttribute("data-theme") === "dark"
                        ? "light"
                        : "dark";
                html.setAttribute("data-theme", newTheme);
                localStorage.setItem("theme", newTheme);
                const [iconToShow, iconToHide] =
                    newTheme === "light"
                        ? [moonIcon, sunIcon]
                        : [sunIcon, moonIcon];
                iconToShow.style.display = "";
                iconToHide.style.display = "none";
            });

            window.onload = function() {
                document.documentElement.removeAttribute("class");
            };
        </script>
    </body>
</html>
